<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  <meta charset="utf-8">
  <meta name="author" content="zchengsite, 1451426471@qq.com" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  
  <title>Pandas简易教程 | To be a legend</title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">


  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


  

<meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="To be a legend" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/"><img src="/images/avatar.png" alt=""></a>
    <div class="nickname"><a href="/">To be a legend</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">主页</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">归档</a>
        </li>
      
        <li class="nav-item" data-path="/categories/">
          <a href="/categories/">分类</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">标签</a>
        </li>
      
        <li class="nav-item" data-path="/tools/">
          <a href="/tools/">实用工具</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">关于</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->



  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">Pandas简易教程</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime" title="更新时间 | updatetime"></i>
          2021-03-02
        </span>
        
              <span class="post-categories">
                <i class="iconfont icon-bookmark" title="类别 | categories"></i>
                
                <span class="span--category">
                  <a href="/categories/python%E5%B8%B8%E7%94%A8%E5%BA%93/" title="查看 python常用库 分类">
                    <b>#</b> python常用库
                  </a>
                </span>
                
              </span>
          
              <span class="post-tags">
                <i class="iconfont icon-tags" title="标签 | tags"></i>
                
                <span class="span--tag">
                  <a href="/tags/Pandas/" title="查看 Pandas 标签">
                    <b>#</b> Pandas
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <blockquote>
<p>Pandas是Python的核心数据分析支持库，提供了快速、灵活、明确的数据结构，旨在简单、直观地处理关系型、标记型数据。</p>
</blockquote>
<h2 id="1-Pandas数据结构"><a href="#1-Pandas数据结构" class="headerlink" title="1 Pandas数据结构"></a>1 Pandas数据结构</h2><p>Pandas的主要数据结构是Series（一维数据）与DataFrame（二维数据）。</p>
<h3 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h3><p>Series是带标签的一维数组，标签又被称为索引，通过调用pd.Series创建Series：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series(data, index=index)</span><br></pre></td></tr></table></figure>
<p>上述代码中data支持以下数据类型：</p>
<ul>
<li>Python字典</li>
<li>一维数组</li>
<li>标量值</li>
</ul>
<p>index是轴标签列表（允许重复），示例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># data为字典时，可省略index参数，因为字典中的key被作为索引，value作为Series中的值</span></span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">0.</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">1.</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">2.</span>&#125;</span><br><span class="line">print(pd.Series(d))</span><br><span class="line">Out:</span><br><span class="line">a    <span class="number">0.0</span></span><br><span class="line">b    <span class="number">1.0</span></span><br><span class="line">c    <span class="number">2.0</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"><span class="comment"># data为一位数组时，index长度必须与data一致，从而作为Series的索引。没有指定index时。创建数值型索引，即[0, ..., len(data) - 1]</span></span><br><span class="line">s = pd.Series(np.arange(<span class="number">5</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(s)</span><br><span class="line">Out:</span><br><span class="line">a   <span class="number">0</span></span><br><span class="line">b   <span class="number">1</span></span><br><span class="line">c   <span class="number">2</span></span><br><span class="line">d   <span class="number">3</span></span><br><span class="line">e   <span class="number">4</span></span><br><span class="line">dtype: int32</span><br><span class="line"></span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">5</span>))</span><br><span class="line">print(s)</span><br><span class="line">Out:</span><br><span class="line"><span class="number">0</span>   <span class="number">-0.173215</span></span><br><span class="line"><span class="number">1</span>    <span class="number">0.119209</span></span><br><span class="line"><span class="number">2</span>   <span class="number">-1.044236</span></span><br><span class="line"><span class="number">3</span>   <span class="number">-0.861849</span></span><br><span class="line"><span class="number">4</span>   <span class="number">-2.104569</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"><span class="comment"># data为标量值时，必须提供index，Series按索引长度重复该标量值</span></span><br><span class="line">s = pd.Series(<span class="number">5.</span>, index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(s)</span><br><span class="line">Out:</span><br><span class="line">a   <span class="number">5.0</span></span><br><span class="line">b   <span class="number">5.0</span></span><br><span class="line">c   <span class="number">5.0</span></span><br><span class="line">d   <span class="number">5.0</span></span><br><span class="line">e   <span class="number">5.0</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<h3 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h3><p>DataFrame是由多种类型的列构成的二维标签数据结构，通过调用pd.DataFrame创建DataFrame：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data, index=index, columns=columns)</span><br></pre></td></tr></table></figure>
<p>上述代码中data支持多种类型的输入数据，最常见的两种：</p>
<ul>
<li>字典</li>
<li>二维数组</li>
</ul>
<p>index为行标签，columns为列标签，这两个参数可以有选择传递，缺失时自动设置为数值型索引，示例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># data为字典时，字典的key作为列标签，value作为该列的值</span></span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span>: [<span class="number">1.</span>，<span class="number">2.</span>，<span class="number">3.</span>]， ‘two’: [<span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>]&#125;</span><br><span class="line">print(pd.DataFrame(d))</span><br><span class="line">Out:</span><br><span class="line">   one  two</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">4.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2.0</span>  <span class="number">5.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3.0</span>  <span class="number">6.0</span></span><br><span class="line"></span><br><span class="line">print(pd.DataFrame(d, index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]))</span><br><span class="line">Out:</span><br><span class="line">   one  two</span><br><span class="line">a  <span class="number">1.0</span>  <span class="number">4.0</span></span><br><span class="line">b  <span class="number">2.0</span>  <span class="number">5.0</span></span><br><span class="line">c  <span class="number">3.0</span>  <span class="number">6.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># data为二维数组时</span></span><br><span class="line">data = [[<span class="number">1</span>, <span class="number">2.</span>, <span class="string">&#x27;Hello&#x27;</span>], [<span class="number">2</span>, <span class="number">3.</span> <span class="string">&#x27;World&#x27;</span>]]</span><br><span class="line">print(pd.DataFrame(data, index=[<span class="string">&#x27;first&#x27;</span>, <span class="string">&#x27;second&#x27;</span>], columns=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]))</span><br><span class="line">Out:</span><br><span class="line">        A    B        C</span><br><span class="line">first   <span class="number">1</span>  <span class="number">2.0</span>  <span class="string">&#x27;Hello&#x27;</span></span><br><span class="line">second  <span class="number">2</span>  <span class="number">3.0</span>  <span class="string">&#x27;World&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过shape属性可以查看DataFrame的行列数</span></span><br><span class="line"><span class="comment"># 获取行数</span></span><br><span class="line">df.shape[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 获取列数</span></span><br><span class="line">df.shape[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h2 id="2-索引"><a href="#2-索引" class="headerlink" title="2 索引"></a>2 索引</h2><p>这里我们主要介绍DataFrame的索引，与NumPy类似，Pandas中也用’[]’进行索引，首先介绍loc[]与iloc[]，为了展示它们的用法，我们首先生成一个DataFrame：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"> </span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20130101&#x27;</span>, periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>, <span class="number">4</span>), index=dates, columns=list(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>	<span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>	<span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br></pre></td></tr></table></figure>
<p>下面分别使用loc[]和iloc[]进行索引：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># loc[]进行索引，使用index和columns作为索引值</span></span><br><span class="line">print(df.loc[<span class="string">&#x27;20210102&#x27;</span>:<span class="string">&#x27;20210104&#x27;</span>, [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]])</span><br><span class="line">Out:</span><br><span class="line">                    A        B</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">-0.850671</span>	<span class="number">0.931060</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">-0.707002</span>	<span class="number">0.782471</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">-0.995113</span>	<span class="number">1.151352</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># iloc[]进行索引，使用数值作为索引值</span></span><br><span class="line">print(df.iloc[<span class="number">3</span>:<span class="number">5</span>, <span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line">Out:</span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span></span><br></pre></td></tr></table></figure>
<p>此外DataFrame也支持通过’.column_name’直接索引某一列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过列名索引，返回Series</span></span><br><span class="line">print(df.A)</span><br><span class="line">Out:</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>    <span class="number">0.702302</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">-0.850671</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">-0.707002</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>   <span class="number">-0.995113</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>    <span class="number">0.115534</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">0.999743</span></span><br><span class="line">Freq: D, Name: A, dtype: float64</span><br></pre></td></tr></table></figure>
<p>同样也支持布尔索引：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用单列的值选择数据</span></span><br><span class="line">print(df[df.A &gt; <span class="number">0</span>])</span><br><span class="line">Out:</span><br><span class="line">                   A         B          C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span>  <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span>  <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span>  <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择DataFrame里满足条件的值</span></span><br><span class="line">print(df[df &gt; <span class="number">0</span>])</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span>       NaN  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span>       NaN  <span class="number">0.931060</span>  <span class="number">0.009759</span>       NaN</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span>       NaN  <span class="number">0.782471</span>       NaN       NaN</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>       NaN  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span>       NaN       NaN</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span>       NaN       NaN       NaN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用isin()筛选</span></span><br><span class="line">df2 = df.copy()</span><br><span class="line">df2[<span class="string">&#x27;E&#x27;</span>] = [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>, <span class="string">&#x27;three&#x27;</span>]</span><br><span class="line">print(df2)</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D      E</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span>    one</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span>    one</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span>    two</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span>  three</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span>   four</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span>  three</span><br><span class="line"></span><br><span class="line">print(df2[df2.E.isin([<span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;four&#x27;</span>])])</span><br><span class="line">Out:</span><br><span class="line">                   A         B          C         D     E</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span>  <span class="number">-0.300577</span> <span class="number">-0.656307</span>   two</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span>  <span class="number">-1.067168</span> <span class="number">-0.264042</span>  four</span><br></pre></td></tr></table></figure>
<h2 id="3-数据的增删改"><a href="#3-数据的增删改" class="headerlink" title="3 数据的增删改"></a>3 数据的增删改</h2><h3 id="更改数据"><a href="#更改数据" class="headerlink" title="更改数据"></a>更改数据</h3><p>对数据的更改可以利用索引方法选中数据，然后直接赋值即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;20130101&#x27;</span>, <span class="string">&#x27;A&#x27;</span>] = <span class="number">0</span></span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.000000</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br></pre></td></tr></table></figure>
<h3 id="增添数据"><a href="#增添数据" class="headerlink" title="增添数据"></a>增添数据</h3><p>若想在DataFrame列末增添一列数据，直接像Python字典一样操作即可；若想在指定位置插入一列数据，调用reindex方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在列末增添一列数据</span></span><br><span class="line">df2 = df.copy()</span><br><span class="line">df2[<span class="string">&#x27;E&#x27;</span>] = [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>, <span class="string">&#x27;four&#x27;</span>, <span class="string">&#x27;three&#x27;</span>]</span><br><span class="line">print(df2)</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D      E</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span>    one</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span>    one</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span>    two</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span>  three</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span>   four</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span>  three</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在指定位置插入一列数据</span></span><br><span class="line">columns_name = df.columns.tolist()</span><br><span class="line">columns_name.insert(<span class="number">2</span>, <span class="string">&#x27;F&#x27;</span>)</span><br><span class="line">df2 = df.reindex(columns=columns_name)</span><br><span class="line">df2[<span class="string">&#x27;F&#x27;</span>] = [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.4</span>]</span><br><span class="line">print(df2)</span><br><span class="line">Out:</span><br><span class="line">                   A         B    F         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span>  <span class="number">0.1</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.2</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span>  <span class="number">0.3</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">0.4</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span>  <span class="number">0.5</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span>  <span class="number">0.6</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><span id="jump"></span>若想增添一行数据，可以使用append方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># append函数可以传入一个Series，Series中的data作为各列的值，name作为该行的index</span></span><br><span class="line">print(df.append(pd.Series(&#123;<span class="string">&#x27;A&#x27;</span>: <span class="number">0.1</span>, <span class="string">&#x27;B&#x27;</span>: <span class="number">0.2</span>, <span class="string">&#x27;C&#x27;</span>: <span class="number">0.3</span>, <span class="string">&#x27;D&#x27;</span>: <span class="number">0.4</span>&#125;, name=pd.to_datetime(<span class="string">&#x27;20210107&#x27;</span>))))</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-07</span>  <span class="number">0.100000</span>  <span class="number">0.200000</span>  <span class="number">0.300000</span>  <span class="number">0.400000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># append函数还可以传入一个字典，作为各列的值，但是这样的话不知道新行的index，所以需要指定ignore_index=True（原来的index会变成数值索引，新添加的行的index会自动递增）</span></span><br><span class="line">print(df.append(&#123;<span class="string">&#x27;A&#x27;</span>: <span class="number">0.1</span>, <span class="string">&#x27;B&#x27;</span>: <span class="number">0.2</span>, <span class="string">&#x27;C&#x27;</span>: <span class="number">0.3</span>, <span class="string">&#x27;D&#x27;</span>: <span class="number">0.4</span>&#125;, ignore_index=<span class="literal">True</span>))</span><br><span class="line">Out:</span><br><span class="line">          A         B         C         D</span><br><span class="line"><span class="number">0</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">1</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">3</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"><span class="number">6</span>  <span class="number">0.100000</span>  <span class="number">0.200000</span>  <span class="number">0.300000</span>  <span class="number">0.400000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># append方法也支持传入一个DataFrame，来实现在原DataFrame后拼接上另一个DataFrame，但是不建议这样做，因为拼接两个DataFrame时使用concat效率更高</span></span><br></pre></td></tr></table></figure>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p>删除行列都可以使用drop函数来搞定：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除行时，指定index</span></span><br><span class="line">print(df.drop(index=[dates[<span class="number">3</span>], dates[<span class="number">4</span>]]))</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除列时，指定columns</span></span><br><span class="line">print(df.drop(columns=[<span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]))</span><br><span class="line">Out:</span><br><span class="line">                   A         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.162591</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="4-统计与排序"><a href="#4-统计与排序" class="headerlink" title="4 统计与排序"></a>4 统计与排序</h2><h3 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h3><p>Pandas与NumPy一样，都可以通过调用mean，std，min，max等方法来获取统计值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计列均值</span></span><br><span class="line">print(df.mean())</span><br><span class="line">Out:</span><br><span class="line">A   <span class="number">-0.122535</span></span><br><span class="line">B    <span class="number">0.535833</span></span><br><span class="line">C   <span class="number">-0.111205</span></span><br><span class="line">D   <span class="number">-0.243679</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计行均值</span></span><br><span class="line">print(df.mean(axis=<span class="number">1</span>))</span><br><span class="line">Out:</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>    <span class="number">0.256565</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">-0.210573</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">-0.220354</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>    <span class="number">0.445305</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>   <span class="number">-0.249326</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">0.066005</span></span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></table></figure>
<p>此外Pandas还支持调用describe方法快速查看数据的统计摘要：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">print(df.describe())</span><br><span class="line">Out:</span><br><span class="line">              A         B         C         D </span><br><span class="line">count  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span></span><br><span class="line"> mean <span class="number">-0.122535</span>  <span class="number">0.535833</span> <span class="number">-0.111205</span> <span class="number">-0.243679</span></span><br><span class="line">  std  <span class="number">0.852023</span>  <span class="number">0.533113</span>  <span class="number">0.885529</span>  <span class="number">0.502647</span></span><br><span class="line">  min <span class="number">-0.995113</span> <span class="number">-0.310052</span> <span class="number">-1.067168</span> <span class="number">-0.932437</span></span><br><span class="line">  <span class="number">25</span>% <span class="number">-0.814754</span>  <span class="number">0.274228</span> <span class="number">-0.511466</span> <span class="number">-0.558241</span></span><br><span class="line">  <span class="number">50</span>% <span class="number">-0.295734</span>  <span class="number">0.612135</span> <span class="number">-0.281827</span> <span class="number">-0.213317</span></span><br><span class="line">  <span class="number">75</span>%  <span class="number">0.555610</span>  <span class="number">0.893913</span> <span class="number">-0.058450</span>  <span class="number">0.026388</span></span><br><span class="line">  max  <span class="number">0.999743</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.463922</span></span><br></pre></td></tr></table></figure>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>Pandas支持对索引或者值进行排序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照行索引排序</span></span><br><span class="line">print(df.sort_index())</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照列索引排序</span></span><br><span class="line">print(df.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>))</span><br><span class="line">Out:</span><br><span class="line">                   D         C         B         A</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.463922</span> <span class="number">-0.581762</span>  <span class="number">0.441799</span>  <span class="number">0.702302</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.932437</span>  <span class="number">0.009759</span>  <span class="number">0.931060</span> <span class="number">-0.850671</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.656307</span> <span class="number">-0.300577</span>  <span class="number">0.782471</span> <span class="number">-0.707002</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">0.089382</span>  <span class="number">1.535598</span>  <span class="number">1.151352</span> <span class="number">-0.995113</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-0.264042</span> <span class="number">-1.067168</span>  <span class="number">0.218370</span>  <span class="number">0.115534</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span> <span class="number">-0.162591</span> <span class="number">-0.263078</span> <span class="number">-0.310052</span>  <span class="number">0.999743</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照某一列或多个列的值排序</span></span><br><span class="line">print(df.sort_values(by=<span class="string">&#x27;B&#x27;</span>))</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"></span><br><span class="line">print(df.sort_values(by=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]))</span><br><span class="line">Out:</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.995113</span>  <span class="number">1.151352</span>  <span class="number">1.535598</span>  <span class="number">0.089382</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.850671</span>  <span class="number">0.931060</span>  <span class="number">0.009759</span> <span class="number">-0.932437</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.707002</span>  <span class="number">0.782471</span> <span class="number">-0.300577</span> <span class="number">-0.656307</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0.115534</span>  <span class="number">0.218370</span> <span class="number">-1.067168</span> <span class="number">-0.264042</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.702302</span>  <span class="number">0.441799</span> <span class="number">-0.581762</span>  <span class="number">0.463922</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.999743</span> <span class="number">-0.310052</span> <span class="number">-0.263078</span> <span class="number">-0.162591</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="5-合并"><a href="#5-合并" class="headerlink" title="5 合并"></a>5 合并</h2><h3 id="结合（concat）"><a href="#结合（concat）" class="headerlink" title="结合（concat）"></a>结合（concat）</h3><p>concat用于连接Pandas对象（Series，DataFrame）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">9</span>, <span class="number">4</span>))</span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line">	        <span class="number">0</span>	        <span class="number">1</span>	        <span class="number">2</span>	        <span class="number">3</span></span><br><span class="line"><span class="number">0</span>	<span class="number">-0.302649</span>	 <span class="number">0.452261</span>	 <span class="number">0.419548</span>	 <span class="number">0.506322</span></span><br><span class="line"><span class="number">1</span>	<span class="number">-1.146595</span>	 <span class="number">1.055042</span>	 <span class="number">0.941397</span>	<span class="number">-2.141264</span></span><br><span class="line"><span class="number">2</span>	 <span class="number">0.410302</span>	 <span class="number">0.521420</span>	<span class="number">-0.723361</span>	<span class="number">-0.811100</span></span><br><span class="line"><span class="number">3</span>	 <span class="number">1.635512</span>	 <span class="number">0.785042</span>	<span class="number">-1.935014</span>	 <span class="number">0.165986</span></span><br><span class="line"><span class="number">4</span>	 <span class="number">0.389640</span>	<span class="number">-0.365886</span>	<span class="number">-1.364456</span>	<span class="number">-0.151598</span></span><br><span class="line"><span class="number">5</span>	 <span class="number">0.655289</span>	 <span class="number">1.006355</span>	<span class="number">-0.700695</span>	 <span class="number">0.037120</span></span><br><span class="line"><span class="number">6</span>	 <span class="number">0.971382</span>	 <span class="number">0.451458</span>	 <span class="number">0.425854</span>	<span class="number">-0.523181</span></span><br><span class="line"><span class="number">7</span>	<span class="number">-1.822277</span>	<span class="number">-0.540620</span>	<span class="number">-0.696694</span>	<span class="number">-0.326853</span></span><br><span class="line"><span class="number">8</span>	 <span class="number">0.965950</span>	<span class="number">-1.503654</span>	 <span class="number">1.817247</span>	 <span class="number">1.014299</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将df分成三组</span></span><br><span class="line">pieces = [df[:<span class="number">3</span>], df[<span class="number">3</span>:<span class="number">6</span>], df[<span class="number">6</span>:]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将三组拼接回原来的df</span></span><br><span class="line">print(pd.concat(pieces))</span><br><span class="line">Out:</span><br><span class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></span><br><span class="line"><span class="number">0</span> <span class="number">-0.302649</span>  <span class="number">0.452261</span>  <span class="number">0.419548</span>  <span class="number">0.506322</span></span><br><span class="line"><span class="number">1</span> <span class="number">-1.146595</span>  <span class="number">1.055042</span>  <span class="number">0.941397</span> <span class="number">-2.141264</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.410302</span>  <span class="number">0.521420</span> <span class="number">-0.723361</span> <span class="number">-0.811100</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.635512</span>  <span class="number">0.785042</span> <span class="number">-1.935014</span>  <span class="number">0.165986</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.389640</span> <span class="number">-0.365886</span> <span class="number">-1.364456</span> <span class="number">-0.151598</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.655289</span>  <span class="number">1.006355</span> <span class="number">-0.700695</span>  <span class="number">0.037120</span></span><br><span class="line"><span class="number">6</span>  <span class="number">0.971382</span>  <span class="number">0.451458</span>  <span class="number">0.425854</span> <span class="number">-0.523181</span></span><br><span class="line"><span class="number">7</span> <span class="number">-1.822277</span> <span class="number">-0.540620</span> <span class="number">-0.696694</span> <span class="number">-0.326853</span></span><br><span class="line"><span class="number">8</span>  <span class="number">0.965950</span> <span class="number">-1.503654</span>  <span class="number">1.817247</span>  <span class="number">1.014299</span></span><br></pre></td></tr></table></figure>
<h3 id="追加（append）"><a href="#追加（append）" class="headerlink" title="追加（append）"></a>追加（append）</h3><p>append用于为DataFrame追加行（追加DataFrame也可以，但是更推荐使用concat来拼接两个DataFrame，因为效率更高），代码示例已在第3节的<a href="#jump">增添数据</a>中展示。</p>
<h3 id="连接（merge）"><a href="#连接（merge）" class="headerlink" title="连接（merge）"></a>连接（merge）</h3><p>merge用于连接<strong>两个</strong>DataFrame，连接方式与SQL中的join类似：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;ID&#x27;</span>: [<span class="string">&#x27;001&#x27;</span>, <span class="string">&#x27;002&#x27;</span>], <span class="string">&#x27;lval&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>]&#125;)</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;ID&#x27;</span>: [<span class="string">&#x27;001&#x27;</span>, <span class="string">&#x27;002&#x27;</span>], <span class="string">&#x27;rval&#x27;</span>: [<span class="number">3</span>, <span class="number">4</span>]&#125;)</span><br><span class="line"></span><br><span class="line">print(left)</span><br><span class="line">Out:</span><br><span class="line">   ID lval</span><br><span class="line"><span class="number">0</span> <span class="number">001</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">002</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">print(right)</span><br><span class="line">Out:</span><br><span class="line">   ID rval</span><br><span class="line"><span class="number">0</span> <span class="number">001</span> <span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">002</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">print(pd.merge(left, right, on=<span class="string">&#x27;ID&#x27;</span>))</span><br><span class="line">Out:</span><br><span class="line">   ID lval  rval</span><br><span class="line"><span class="number">0</span> <span class="number">001</span>    <span class="number">1</span>     <span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">002</span>    <span class="number">2</span>     <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>merge函数与SQL类似，同样支持左连接（left），右连接（right），外连接（outer），内连接（inner），调用时设置how参数即可：how = ‘left’/‘right’/‘outer’/‘inner’。</p>
<h2 id="6-分组"><a href="#6-分组" class="headerlink" title="6 分组"></a>6 分组</h2><blockquote>
<p>分组（group by）指的是涵盖下列一项或多项步骤的处理流程：</p>
<ul>
<li>分割：按条件把数据分割成多组；</li>
<li>应用：为每组单独应用函数；</li>
<li>组合：将处理结果组合成一个数据结构。</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;class&#x27;</span>: [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>], <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Jenny&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Marry&#x27;</span>], <span class="string">&#x27;gender&#x27;</span>: [<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>], <span class="string">&#x27;mark&#x27;</span>: [<span class="number">96</span>, <span class="number">97</span>, <span class="number">95</span>, <span class="number">93</span>]&#125;)</span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line"> <span class="class"><span class="keyword">class</span>    <span class="title">name</span>  <span class="title">gender</span>  <span class="title">mark</span></span></span><br><span class="line"><span class="class">0    1    <span class="title">John</span>    <span class="title">male</span>    96</span></span><br><span class="line"><span class="class">1    1   <span class="title">Jenny</span>  <span class="title">female</span>    97</span></span><br><span class="line"><span class="class">2    2     <span class="title">Bob</span>    <span class="title">male</span>    95</span></span><br><span class="line"><span class="class">3    2  <span class="title">Steven</span>  <span class="title">female</span>    93</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 按照<span class="title">class</span>分组，对于每组分别统计平均分</span></span><br><span class="line"><span class="class"># 首先调用<span class="title">groupby</span>进行分组，得到<span class="title">DataFrameGroupby</span>对象</span></span><br><span class="line">df_group = df.groupby(&#x27;class&#x27;)</span><br><span class="line">print(df_group)</span><br><span class="line">Out: &lt;pandas.core.groupby.generic.DataFrameGroupBy object at <span class="number">0x7fe32fb755b0</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为每组单独应用函数（count，sum，mean，max等），注意应用函数时会自动跳过无意义的列，例如统计均值时name,gender列为字符串无意义</span></span><br><span class="line">print(df_group.mean())</span><br><span class="line">Out:</span><br><span class="line">        mark</span><br><span class="line"><span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">    1	  96.5</span></span><br><span class="line"><span class="class">    2	  94.0</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 也可以指定输出某一(<span class="params">多</span>)列，这样结果只输出分组列(<span class="params">输出时分组列的值变为结果的行标签</span>)和指定输出列</span></span><br><span class="line"><span class="class"><span class="title">print</span>(<span class="params">df_group[<span class="string">&#x27;mark&#x27;</span>].mean(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="class"><span class="title">Out</span>:</span></span><br><span class="line">        mark</span><br><span class="line"><span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">    1	  96.5</span></span><br><span class="line"><span class="class">    2	  94.0</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 统计多个分组</span></span><br><span class="line"><span class="class"><span class="title">print</span>(<span class="params">df.groupby(<span class="params">[<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>]</span>).mean(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="class"><span class="title">Out</span>:</span></span><br><span class="line">              mark</span><br><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">gender</span>	</span></span><br><span class="line"><span class="class">    1  <span class="title">female</span>	  97</span></span><br><span class="line"><span class="class">         <span class="title">male</span>	  96</span></span><br><span class="line"><span class="class">    2	 <span class="title">female</span>	  93</span></span><br><span class="line"><span class="class">         <span class="title">male</span>	  95</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 应用多个函数计算</span></span><br><span class="line"><span class="class"><span class="title">print</span>(<span class="params">df.groupby(<span class="params">[<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>]</span>).agg(<span class="params">[<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>]</span>)</span>)</span></span><br><span class="line"><span class="class"><span class="title">Out</span>:</span></span><br><span class="line">            mark</span><br><span class="line">            mean sum</span><br><span class="line"><span class="class"><span class="keyword">class</span>	<span class="title">gender</span>		</span></span><br><span class="line"><span class="class">    1	<span class="title">female</span>	97	97</span></span><br><span class="line"><span class="class">       <span class="title">male</span>	  96	96</span></span><br><span class="line"><span class="class">    2	<span class="title">female</span>	93	93</span></span><br><span class="line"><span class="class">        <span class="title">male</span>	95	95</span></span><br></pre></td></tr></table></figure>
<h2 id="7-重塑"><a href="#7-重塑" class="headerlink" title="7 重塑"></a>7 重塑</h2><p>重塑的操作主要是针对Multi-Index的Series/DataFrame，即index有多个层级，例如上节中统计多个分组的输出结果，class为第一层级index，gender为第二层级index。首先介绍stack与unstack两种操作：</p>
<h3 id="堆叠（stack）"><a href="#堆叠（stack）" class="headerlink" title="堆叠（stack）"></a>堆叠（stack）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">multi_df = df.groupby([<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>]).mean()</span><br><span class="line">print(multi_df)</span><br><span class="line">Out:</span><br><span class="line">              mark</span><br><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">gender</span>	</span></span><br><span class="line"><span class="class">    1  <span class="title">female</span>	  97</span></span><br><span class="line"><span class="class">         <span class="title">male</span>	  96</span></span><br><span class="line"><span class="class">    2	 <span class="title">female</span>	  93</span></span><br><span class="line"><span class="class">         <span class="title">male</span>	  95</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 进行<span class="title">stack</span>操作，<span class="title">stack</span>操作可以把所有的列堆叠到行，这样输出的就是具有多个层级标签的<span class="title">Series</span></span></span><br><span class="line"><span class="class"><span class="title">print</span>(<span class="params">multi_df.stack(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="class"><span class="title">Out</span>:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">gender</span>      </span></span><br><span class="line"><span class="class">    1  <span class="title">female</span>  <span class="title">mark</span>    97</span></span><br><span class="line"><span class="class">         <span class="title">male</span>  <span class="title">mark</span>    96</span></span><br><span class="line"><span class="class">    2  <span class="title">female</span>  <span class="title">mark</span>    93</span></span><br><span class="line"><span class="class">         <span class="title">male</span>  <span class="title">mark</span>    95</span></span><br><span class="line"><span class="class"><span class="title">dtype</span>:</span> int64</span><br><span class="line"><span class="comment"># 注意这里的class和gender只是index列表的name，而不是columns</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># unstack为stack逆操作，可以把多层标签的Series的某一层级还原成列，从而把一维的Series还原成二维的DataFrame</span></span><br><span class="line">print(multi_df.stack().unstack())</span><br><span class="line">Out:</span><br><span class="line">              mark</span><br><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">gender</span>	</span></span><br><span class="line"><span class="class">    1  <span class="title">female</span>	  97</span></span><br><span class="line"><span class="class">         <span class="title">male</span>	  96</span></span><br><span class="line"><span class="class">    2	 <span class="title">female</span>	  93</span></span><br><span class="line"><span class="class">         <span class="title">male</span>	  95</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># <span class="title">unstack</span>默认是还原最后一层<span class="title">index</span>，也可以指定还原某一层的<span class="title">index</span></span></span><br><span class="line"><span class="class"><span class="title">print</span>(<span class="params">multi_df.stack(<span class="params"></span>).unstack(<span class="params"><span class="number">1</span></span>)</span>)</span></span><br><span class="line"><span class="class"><span class="title">Out</span>:</span></span><br><span class="line">      gender female male</span><br><span class="line"><span class="class"><span class="keyword">class</span>			</span></span><br><span class="line"><span class="class">    1   <span class="title">mark</span>     97   96</span></span><br><span class="line"><span class="class">    2   <span class="title">mark</span>     93   95</span></span><br><span class="line"><span class="class"># 注意这里的<span class="title">gender</span>不是<span class="title">column</span>，而是<span class="title">columns</span>列表的<span class="title">name</span></span></span><br></pre></td></tr></table></figure>
<h3 id="数据透视表（pivot-table）"><a href="#数据透视表（pivot-table）" class="headerlink" title="数据透视表（pivot table）"></a>数据透视表（pivot table）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;three&#x27;</span>] * <span class="number">3</span>, </span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>] * <span class="number">4</span>, </span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>] * <span class="number">2</span>, </span><br><span class="line">                   <span class="string">&#x27;D&#x27;</span>: np.random.randn(<span class="number">12</span>), </span><br><span class="line">                   <span class="string">&#x27;E&#x27;</span>: np.random.randn(<span class="number">12</span>)&#125;)</span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line">        A  B    C         D         E</span><br><span class="line"><span class="number">0</span>     one  A  foo  <span class="number">1.418757</span> <span class="number">-0.179666</span></span><br><span class="line"><span class="number">1</span>     one  B  foo <span class="number">-1.879024</span>  <span class="number">1.291836</span></span><br><span class="line"><span class="number">2</span>     two  C  foo  <span class="number">0.536826</span> <span class="number">-0.009614</span></span><br><span class="line"><span class="number">3</span>   three  A  bar  <span class="number">1.006160</span>  <span class="number">0.392149</span></span><br><span class="line"><span class="number">4</span>     one  B  bar <span class="number">-0.029716</span>  <span class="number">0.264599</span></span><br><span class="line"><span class="number">5</span>     one  C  bar <span class="number">-1.146178</span> <span class="number">-0.057409</span></span><br><span class="line"><span class="number">6</span>     two  A  foo  <span class="number">0.100900</span> <span class="number">-1.425638</span></span><br><span class="line"><span class="number">7</span>   three  B  foo <span class="number">-1.035018</span>  <span class="number">1.024098</span></span><br><span class="line"><span class="number">8</span>     one  C  foo  <span class="number">0.314665</span> <span class="number">-0.106062</span></span><br><span class="line"><span class="number">9</span>     one  A  bar <span class="number">-0.773723</span>  <span class="number">1.824375</span></span><br><span class="line"><span class="number">10</span>    two  B  bar <span class="number">-1.170653</span>  <span class="number">0.595974</span></span><br><span class="line"><span class="number">11</span>  three  C  bar  <span class="number">0.648740</span>  <span class="number">1.167115</span></span><br><span class="line"></span><br><span class="line">print(pd.pivot_table(df, index=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>], colums=[<span class="string">&#x27;C&#x27;</span>], values=<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line">Out:</span><br><span class="line">C             bar       foo</span><br><span class="line">A     B                    </span><br><span class="line">one   A <span class="number">-0.773723</span>  <span class="number">1.418757</span></span><br><span class="line">      B <span class="number">-0.029716</span> <span class="number">-1.879024</span></span><br><span class="line">      C <span class="number">-1.146178</span>  <span class="number">0.314665</span></span><br><span class="line">three A  <span class="number">1.006160</span>       NaN</span><br><span class="line">      B       NaN <span class="number">-1.035018</span></span><br><span class="line">      C  <span class="number">0.648740</span>       NaN</span><br><span class="line">two   A       NaN  <span class="number">0.100900</span></span><br><span class="line">      B <span class="number">-1.170653</span>       NaN</span><br><span class="line">      C       NaN  <span class="number">0.536826</span></span><br></pre></td></tr></table></figure>
<h2 id="8-其他常用函数"><a href="#8-其他常用函数" class="headerlink" title="8 其他常用函数"></a>8 其他常用函数</h2><h3 id="apply函数"><a href="#apply函数" class="headerlink" title="apply函数"></a>apply函数</h3><p>pandas的apply函数可以作用于整个Series或者DataFrame对象，功能是自动遍历整个Series或者DataFrame，对每一个元素运行指定的函数，并返回一个Series。对于Series，apply会作用于Series中所有元素；对于DataFrame，会沿着指定的axis（行或列）把DataFrame拆成若干个Series（默认axis=0，把每一列作为Series，axis=1，把每一行作为一个Series），然后将指定的函数作用于每一个Series并返回一个Series，最后把所有返回的Series重新拼接回DataFrame。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                   [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                   [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]],</span><br><span class="line">                   index=list(<span class="string">&#x27;abc&#x27;</span>),</span><br><span class="line">                   columns=list(<span class="string">&#x27;xyz&#x27;</span>))</span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line">    x   y   z</span><br><span class="line">a   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line">b   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span></span><br><span class="line">c   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对所有元素进行平方运算</span></span><br><span class="line">print(df.apply(np.square))</span><br><span class="line">Out:</span><br><span class="line">    x   y   z</span><br><span class="line">a   <span class="number">1</span>   <span class="number">4</span>   <span class="number">9</span></span><br><span class="line">b  <span class="number">16</span>  <span class="number">25</span>  <span class="number">36</span></span><br><span class="line">c  <span class="number">49</span>  <span class="number">64</span>  <span class="number">81</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 若将apply函数作用于指定的行和列，可以用行或列的name属性进行限定, 并传入axis指定是行(1)还是列(0)，注意函数里的x是Series类型</span></span><br><span class="line"><span class="comment"># 作用于指定列</span></span><br><span class="line">print(df.apply(<span class="keyword">lambda</span> x : np.square(x) <span class="keyword">if</span> x.name == <span class="string">&#x27;x&#x27;</span> <span class="keyword">else</span> x))</span><br><span class="line">Out:</span><br><span class="line">    x  y  z</span><br><span class="line">a   <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">b  <span class="number">16</span>  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line">c  <span class="number">49</span>  <span class="number">8</span>  <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 作用于指定行</span></span><br><span class="line">print(df.apply(<span class="keyword">lambda</span> x : np.square(x) <span class="keyword">if</span> x.name == <span class="string">&#x27;a&#x27;</span> <span class="keyword">else</span> x), axis=<span class="number">1</span>)</span><br><span class="line">Out:</span><br><span class="line">    x  y  z</span><br><span class="line">a   <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">b  <span class="number">16</span>  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line">c  <span class="number">49</span>  <span class="number">8</span>  <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 操作涉及到不同的行/列，例如对于每一行，若x列值大于等于4，则对于z列值平方</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x[<span class="string">&#x27;x&#x27;</span>] &gt;= <span class="number">4</span>:</span><br><span class="line">        x[<span class="string">&#x27;z&#x27;</span>] = np.square(x[<span class="string">&#x27;z&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">df.apply(square, axis=<span class="number">1</span>)</span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line">  x y  z</span><br><span class="line">a <span class="number">1</span> <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">b <span class="number">4</span> <span class="number">5</span> <span class="number">36</span></span><br><span class="line">c <span class="number">7</span> <span class="number">8</span> <span class="number">81</span></span><br></pre></td></tr></table></figure>
<h3 id="处理缺失值"><a href="#处理缺失值" class="headerlink" title="处理缺失值"></a>处理缺失值</h3><p>Pandas中用np.nan表示缺失数据，计算时默认不包含空值，对缺失值的操作主要包括填充缺失值（fillna），丢弃缺失值（dropna），判断缺失值（isna）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>, np.nan],</span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>: [<span class="number">3</span>, np.nan, np.nan],</span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>: [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]&#125;)</span><br><span class="line">print(df)</span><br><span class="line">Out:</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> NaN <span class="number">7</span></span><br><span class="line"><span class="number">2</span> NaN NaN <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用指定值填充</span></span><br><span class="line">print(df.fillna(value=<span class="number">5</span>))</span><br><span class="line">Out:</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> <span class="number">5.0</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">5.0</span> <span class="number">5.0</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line">print(df[<span class="string">&#x27;A&#x27;</span>].fillna(<span class="number">5</span>))</span><br><span class="line">Out:</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> NaN <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">5.0</span> NaN <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用前面的值填充</span></span><br><span class="line"><span class="comment"># 利用横向前面的值填充</span></span><br><span class="line">print(df.fillna(axis=<span class="number">1</span>, method=<span class="string">&#x27;ffill&#x27;</span>))</span><br><span class="line">Out:</span><br><span class="line">    A   B   C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6.0</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> <span class="number">1.0</span> <span class="number">7.0</span></span><br><span class="line"><span class="number">2</span> NaN NaN <span class="number">8.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用纵向前面的值填充</span></span><br><span class="line">Out:</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> <span class="number">3.0</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">1.0</span> <span class="number">3.0</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不同的列用不同的值填充</span></span><br><span class="line">values = &#123;<span class="string">&#x27;A&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;B&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;C&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line">print(df.fillna(value=values))</span><br><span class="line">Out:</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> <span class="number">2.0</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">1.0</span> <span class="number">2.0</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 丢弃缺失值</span></span><br><span class="line"><span class="comment"># 默认参数：删除行，只要有空值就会删除</span></span><br><span class="line">print(df.dropna())</span><br><span class="line">Out:</span><br><span class="line">    A   B  C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除列</span></span><br><span class="line">print(df.dropna(axis=<span class="number">1</span>))</span><br><span class="line">Out:</span><br><span class="line">  C</span><br><span class="line"><span class="number">0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有值全为缺失值时才删除</span></span><br><span class="line">print(df.drop(how=<span class="string">&#x27;all&#x27;</span>))</span><br><span class="line">Out:</span><br><span class="line">   A    B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> NaN <span class="number">7</span></span><br><span class="line"><span class="number">2</span> NaN NaN <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 至少出现过两个缺失值才删除</span></span><br><span class="line">print(df.dropna(thresh=<span class="number">2</span>))</span><br><span class="line">Out:</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">1.0</span> NaN <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定列中包含缺失值时删除行</span></span><br><span class="line">print(df.dropna(subset=[<span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]))</span><br><span class="line">    A   B C</span><br><span class="line"><span class="number">0</span> <span class="number">0.0</span> <span class="number">3.0</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断缺失值返回布尔掩模</span></span><br><span class="line">print(df.isna())</span><br><span class="line">Out:</span><br><span class="line">      A     B     C</span><br><span class="line"><span class="number">0</span> <span class="literal">False</span> <span class="literal">False</span> <span class="literal">False</span></span><br><span class="line"><span class="number">1</span> <span class="literal">False</span>  <span class="literal">True</span> <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>  <span class="literal">True</span>  <span class="literal">True</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<h3 id="数据I-O"><a href="#数据I-O" class="headerlink" title="数据I/O"></a>数据I/O</h3><p>最常用的I/O操作是对CSV，Excel文件的I/O：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 写入CSV文件：</span></span><br><span class="line">df.to_csv(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取CSV文件：</span></span><br><span class="line">df.read_csv(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入Excel，默认index=True，即写入index：</span></span><br><span class="line">df.to_excel(<span class="string">&#x27;filename&#x27;</span>, index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 读取Excel，默认读取sheet0，默认创建数值型索引：</span></span><br><span class="line">df.read_excel(<span class="string">&#x27;filename&#x27;</span>, sheetname=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 也可以把Excel的某一/多列设置为index：</span></span><br><span class="line">df.read_excel(<span class="string">&#x27;filename&#x27;</span>, index_col=[])</span><br></pre></td></tr></table></figure>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2021/03/01/Python%E6%A0%87%E5%87%86%E5%BA%93-os%E6%A8%A1%E5%9D%97/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>PREV</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime" title="更新时间 | updatetime"></i>
              2021-03-02
            </span>
            
                  <span class="post-categories">
                    <i class="iconfont icon-bookmark" title="类别 | categories"></i>
                    
                    <span class="span--category">
                      <a href="/categories/python%E5%B8%B8%E7%94%A8%E5%BA%93/" title="查看 python常用库 分类">
                        <b>#</b> python常用库
                      </a>
                    </span>
                    
                  </span>
              
                  <span class="post-tags">
                    <i class="iconfont icon-tags" title="标签 | tags"></i>
                    
                    <span class="span--tag">
                      <a href="/tags/Pandas/" title="查看 Pandas 标签">
                        <b>#</b> Pandas
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
          </div>
        </div>
      
    </div>
    
  <div class="post-catalog" id="catalog">
    <div class="title">目录</div>
    <div class="catalog-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Pandas%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">1 Pandas数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Series"><span class="toc-text">Series</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DataFrame"><span class="toc-text">DataFrame</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95"><span class="toc-text">2 索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9"><span class="toc-text">3 数据的增删改</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-text">更改数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E6%B7%BB%E6%95%B0%E6%8D%AE"><span class="toc-text">增添数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-text">删除数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BB%9F%E8%AE%A1%E4%B8%8E%E6%8E%92%E5%BA%8F"><span class="toc-text">4 统计与排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1"><span class="toc-text">统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-text">排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%90%88%E5%B9%B6"><span class="toc-text">5 合并</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E5%90%88%EF%BC%88concat%EF%BC%89"><span class="toc-text">结合（concat）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%BD%E5%8A%A0%EF%BC%88append%EF%BC%89"><span class="toc-text">追加（append）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%EF%BC%88merge%EF%BC%89"><span class="toc-text">连接（merge）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%88%86%E7%BB%84"><span class="toc-text">6 分组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%87%8D%E5%A1%91"><span class="toc-text">7 重塑</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%EF%BC%88stack%EF%BC%89"><span class="toc-text">堆叠（stack）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8%EF%BC%88pivot-table%EF%BC%89"><span class="toc-text">数据透视表（pivot table）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">8 其他常用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#apply%E5%87%BD%E6%95%B0"><span class="toc-text">apply函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-text">处理缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AEI-O"><span class="toc-text">数据I&#x2F;O</span></a></li></ol></li></ol>
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        


  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>

  <div id="vcomments"></div>

  <script>
    new Valine({
      el: '#vcomments',
      appId: 'xCrix3xuQasVLFiY1a1PUTbd-gzGzoHsz',
      appKey: 'bCzXzANH4S53Q03rRywgXAGf',
      placeholder: 'Welcome!',
      avatar: 'retro'
    })
  </script>

    <style>
      .comments-container .v .vempty {
        display: none!important;
      }
    </style>




      </div>
    
  </div>


        <div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" target="_blank" rel="noopener" href="https://github.com/Yihao-Sun">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
        <li>
          <a title="email" href="">
            <i class="iconfont icon-envelope"></i>
          </a>
        </li>
      
        <li>
          <a title="facebook" href="">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        </li>
      
        <li>
          <a title="twitter" href="">
            <i class="iconfont icon-twitter"></i>
          </a>
        </li>
      
        <li>
          <a title="微信" href="">
            <i class="iconfont icon-wechat"></i>
          </a>
        </li>
      
        <li>
          <a title="微博" href="">
            <i class="iconfont icon-weibo"></i>
          </a>
        </li>
      
        <li>
          <a title="rss" href="/atom.xml">
            <i class="iconfont icon-rss"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    <div class="footer-more">
      <a href="">Copyright © Yihao Sun 2020</a>
    </div>
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        <input type="text" class="search-input" id="search-input" placeholder="搜索...">
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile();
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)
  </script>

  
<script src="/js/search.js"></script>




    </div>
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>
</html>
